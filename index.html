<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Fit Lab - æ™ºèƒ½æ‰“å¡ç³»ç»Ÿ</title>
    <style>
        :root {
            --primary: #27ae60;
            --danger: #e74c3c;
            --bg: #f4f7f6;
            --dark: #2c3e50;
        }

        body { font-family: 'PingFang SC', sans-serif; background: var(--bg); margin: 0; padding: 15px; color: var(--dark); }
        .container { max-width: 900px; margin: 0 auto; }
        
        header { text-align: center; padding: 20px 0; }
        header h1 { margin: 0; color: var(--primary); font-size: 24px; }

        .status-board { background: white; border-radius: 20px; padding: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); margin-bottom: 20px; display: flex; justify-content: space-around; text-align: center; }
        .stat-item span { display: block; font-size: 12px; color: #7f8c8d; }
        .stat-item strong { font-size: 20px; color: var(--primary); }

        .calendar-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 15px; }
        
        .day-card { background: white; border-radius: 15px; padding: 15px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); border-top: 5px solid #bdc3c7; }
        .day-card.checked { border-top-color: var(--primary); background: #f0fff4; }
        
        .img-placeholder { width: 100%; height: 150px; background: #eee; border-radius: 10px; display: flex; align-items: center; justify-content: center; cursor: pointer; overflow: hidden; margin: 10px 0; border: 1px dashed #ccc; }
        .img-placeholder img { width: 100%; height: 100%; object-fit: cover; }
        input[type="file"] { display: none; }

        textarea { width: 100%; border: 1px solid #ddd; border-radius: 8px; padding: 8px; box-sizing: border-box; height: 60px; font-size: 14px; margin-bottom: 10px; }

        .btn-check { width: 100%; background: var(--dark); color: white; border: none; padding: 10px; border-radius: 8px; cursor: pointer; font-weight: bold; }
        .btn-check.active { background: var(--primary); }

        .settle-card { background: var(--dark); color: white; grid-column: 1 / -1; margin-top: 20px; padding: 25px; border-radius: 15px; text-align: center; }
        .settle-card input { padding: 10px; border-radius: 8px; border: none; margin: 10px; font-size: 18px; width: 120px; }
        .btn-settle { background: #3498db; color: white; border: none; padding: 12px 30px; border-radius: 8px; font-weight: bold; cursor: pointer; }

        #modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); display: none; align-items: center; justify-content: center; z-index: 100; }
        .modal-content { background: white; padding: 30px; border-radius: 20px; max-width: 80%; text-align: center; color: var(--dark); }
    </style>
</head>
<body>

<div class="container">
    <header><h1>Smart Fit Lab | é¥®é£Ÿæ‰“å¡ç³»ç»Ÿ</h1></header>

    <div class="status-board">
        <div class="stat-item"><span>æœ¬å‘¨æ‰“å¡</span><strong id="check-count">0/6</strong></div>
        <div class="stat-item"><span>çŠ¶æ€</span><strong id="trend">è®°å½•ä¸­</strong></div>
    </div>

    <div class="calendar-grid" id="calendar"></div>

    <div class="settle-card">
        <h3>å‘¨æ—¥ç»“ç®—å¤ç›˜</h3>
        <p>è¾“å…¥ä»Šæ—¥ä½“é‡ï¼ŒæŸ¥çœ‹æœ¬å‘¨æˆæ•ˆåŠä¸‹å‘¨å»ºè®®</p>
        <input type="number" step="0.1" id="weight-input" placeholder="ä½“é‡kg">
        <button class="btn-settle" onclick="runAnalysis()">åˆ†ææ•°æ®</button>
    </div>
</div>

<div id="modal">
    <div class="modal-content">
        <h2 id="modal-title"></h2>
        <p id="modal-body"></p>
        <button style="padding:10px 20px;" onclick="resetWeek()">å¼€å§‹æ–°çš„ä¸€å‘¨</button>
        <button style="padding:10px 20px; background:#ccc;" onclick="document.getElementById('modal').style.display='none'">å…³é—­</button>
    </div>
</div>

<script>
    const days = ['å‘¨ä¸€', 'å‘¨äºŒ', 'å‘¨ä¸‰', 'å‘¨å››', 'å‘¨äº”', 'å‘¨å…­'];
    const tips = [
        "æ²¡ç˜¦ï¼Ÿä¸‹å‘¨è¯•ç€æŠŠæ™šé¤æ¢æˆçº¯è”¬èœ+è›‹ç™½è´¨ï¼Œä¸åƒæ·€ç²‰ã€‚",
        "æ²¡ç˜¦ï¼Ÿå¢åŠ é¥®æ°´é‡ï¼Œæ¯å¤©ä¿è¯2000mlä»¥ä¸Šï¼Œæå‡ä»£è°¢ã€‚",
        "æ²¡ç˜¦ï¼Ÿæ£€æŸ¥æ˜¯å¦æœ‰éšè—é›¶é£Ÿï¼Œä¸‹å‘¨åŠ å…¥3æ¬¡30åˆ†é’Ÿå¿«èµ°ã€‚",
        "ç˜¦äº†ï¼å½“å‰é¥®é£Ÿæ–¹æ¡ˆéå¸¸é€‚åˆä½ ï¼Œè¯·ç»§ç»­ä¿æŒï¼"
    ];

    window.onload = () => {
        const grid = document.getElementById('calendar');
        days.forEach((day, i) => {
            const saved = JSON.parse(localStorage.getItem(`diet-day-${i}`)) || {};
            grid.innerHTML += `
                <div class="day-card ${saved.checked ? 'checked' : ''}" id="card-${i}">
                    <strong>${day}</strong>
                    <label class="img-placeholder">
                        <img src="${saved.img || ''}" id="prev-${i}" style="display:${saved.img ? 'block' : 'none'}">
                        <span id="text-${i}" style="display:${saved.img ? 'none' : 'block'}">ğŸ“· ç‚¹å‡»ä¸Šä¼ å›¾ç‰‡</span>
                        <input type="file" accept="image/*" onchange="preview(${i}, this)">
                    </label>
                    <textarea id="note-${i}" placeholder="åƒäº†ä»€ä¹ˆï¼Ÿ">${saved.note || ''}</textarea>
                    <button class="btn-check ${saved.checked ? 'active' : ''}" onclick="toggleDay(${i})">
                        ${saved.checked ? 'å·²æ‰“å‹¾ âœ“' : 'æ‰“å‹¾å®Œæˆ'}
                    </button>
                </div>`;
        });
        updateStats();
    };

    function preview(i, input) {
        const reader = new FileReader();
        reader.onload = e => {
            document.getElementById(`prev-${i}`).src = e.target.result;
            document.getElementById(`prev-${i}`).style.display = 'block';
            document.getElementById(`text-${i}`).style.display = 'none';
            saveData(i);
        };
        reader.readAsDataURL(input.files[0]);
    }

    function toggleDay(i) {
        const btn = document.querySelector(`#card-${i} .btn-check`);
        btn.classList.toggle('active');
        saveData(i);
        location.reload();
    }

    function saveData(i) {
        const card = document.getElementById(`card-${i}`);
        const data = {
            checked: card.querySelector('.btn-check').classList.contains('active'),
            img: document.getElementById(`prev-${i}`).src,
            note: document.getElementById(`note-${i}`).value
        };
        localStorage.setItem(`diet-day-${i}`, JSON.stringify(data));
        updateStats();
    }

    function updateStats() {
        let count = 0;
        for(let i=0; i<6; i++) {
            if(JSON.parse(localStorage.getItem(`diet-day-${i}`))?.checked) count++;
        }
        document.getElementById('check-count').innerText = `${count}/6`;
    }

    function runAnalysis() {
        const weight = document.getElementById('weight-input').value;
        if(!weight) return alert("è¯·è¾“å…¥ä½“é‡");
        
        const modal = document.getElementById('modal');
        const isSuccess = weight < 70; // å‡è®¾åˆå§‹å€¼
        document.getElementById('modal-title').innerText = isSuccess ? "ğŸ‰ æ­å–œï¼" : "ğŸ’¡ å»ºè®®";
        document.getElementById('modal-body').innerText = isSuccess ? tips[3] : tips[Math.floor(Math.random()*3)];
        modal.style.display = 'flex';
    }

    function resetWeek() {
        if(confirm("ç¡®å®šæ¸…ç©ºæ•°æ®å¼€å§‹æ–°ä¸€å‘¨å—ï¼Ÿ")) {
            localStorage.clear();
            location.reload();
        }
    }
</script>
</body>
</html>
